const vuetify=new Vuetify(vuetify_opts),api_url=ra_elite_usa_insurance_ajaxurl;Vue.component("line-chart",{extends:VueChartJs.Bar,mixins:VueChartJs.mixins.reactiveProp,props:["chartdata","options"],mounted(){this.renderChart(this.chartdata,{responsive:!0,maintainAspectRatio:!0})}});let vm=new Vue({vuetify:vuetify,el:"#ra-elite-usa-insurance-container",data:{selectedItem:3,loading:!1,logout_loading:!1,agents_loading:!1,quotes_loading:!1,notifications_loading:!1,search_agent:"",notifications:[],year:parseInt(moment().format("YYYY")),years:[2023,2022,2021],agent:{},agents:[],agents_source:[],quotes:[],status:"Approved",status_items:["Processing","In tray","Approved","Archived"],chart:{loading:!0,monthly_data:{current_year:"",months:["01","02","03","04","05","06","07","08","09","10","11","12"],labels:["January","February","March","April","May","June","July","August","September","October","November","December"],datasets:[{label:"New",backgroundColor:"#000",data:[]},{label:"Renewals",backgroundColor:vuetify.preset.theme.themes.light.secondary,data:[]},{label:"Total",backgroundColor:vuetify.preset.theme.themes.light.primary,data:[0,0,0,0,0,0,0,0,0,0,0,0]}]}}},computed:{},watch:{agent(t){this.loadStatistics()},year(t){this.chart.monthly_data.current_year=t,this.loadStatistics()},status(t){this.loadStatistics()}},created(){initNotifications(this),setInterval(initNotifications,3e4,this)},mounted(){this.initialize()},methods:{initialize(){this.chart.monthly_data.current_year=this.year,this.loadYears(),this.loadAgents().then(()=>this.loadQuotes())},logout(){let t=this,e=api_url+"ra_elite_usa_insurance_logout";t.logout_loading=!0,t.$http.get(e).then(e=>{t.logout_loading=!1,window.location=e.body.redirect_url},e=>{t.logout_loading=!1})},async loadAgents(){let t=this,e=api_url+"ra_elite_usa_insurance_get_users",a={args:{role__in:["elite_usa_insurance_agent"]}};t.agents_loading=!0,t.$http.post(e,a).then(e=>{t.agents=t.agents_source=e.body,t.agents_loading=!1},e=>{t.agents_loading=!1})},loadQuotes(){let t=this,e=api_url+"ra_elite_usa_insurance_get_quotes";t.quotes_loading=!0,t.$http.get(e).then(e=>{if(e.body.length>0){var a=[];e.body.forEach(t=>{var e=t;e.published_at=moment(e.affordable_care_act.date).format("DD/MM/YYYY, h:mm:ss a"),e.applicant=e.personal_information.first_name+" "+e.personal_information.middle_name+" "+e.personal_information.last_name,e.type=e.post_parent<=0?"First-Time":"Renewal",e.personal_information.same_address=e.personal_information.hasOwnProperty("same_address")?e.personal_information.same_address:1,e.affordable_care_act.hasOwnProperty("renewal_date")?e.year=moment(e.affordable_care_act.renewal_date).format("YYYY"):e.year=moment(e.affordable_care_act.effectiveness_date).isSameOrAfter(moment(e.affordable_care_act.date))?moment(e.affordable_care_act.effectiveness_date).format("YYYY"):moment(e.affordable_care_act.date).format("YYYY"),a.push(e)}),t.quotes=a}t.quotes_loading=!1,t.loadStatistics()},e=>{t.quotes_loading=!1})},loadYears(){},loadStatistics(){let t=this,e=Object.assign({},t.agent),a=t.chart.monthly_data.current_year,r=t.status;if(filtered_items=t.quotes,t.chart.loading=!0,void 0!==e&&""!==e&&Object.keys(e).length>0&&(filtered_items=filtered_items.filter(t=>t.post_author==e.id)),null==a||""==a)return t.chart.loading=!1,!1;filtered_items=filtered_items.filter(t=>t.published_at.includes(a)),null==r&&""==r||(filtered_items=filtered_items.filter(t=>t.status==r)),t.chart.monthly_data.months.forEach((e,r)=>{var s=filtered_items.filter(t=>t.published_at.includes(`${e}/${a}`)),i=s.filter(t=>"First-Time"==t.type),n=s.filter(t=>"Renewal"==t.type);t.chart.monthly_data.datasets[0].data[r]=i.length,t.chart.monthly_data.datasets[1].data[r]=n.length,t.chart.monthly_data.datasets[2].data[r]=i.length+n.length,void 0!==t.$refs.monthly_chart&&t.$refs.monthly_chart.renderChart(t.chart.monthly_data),t.chart.loading=!1})},searchAgents(t){let e=this;e.search_agent||(e.agents=e.agents_source),e.agents=e.agents_source.filter(t=>{var a=`${t.first_name} ${t.last_name}`;return a.toLowerCase().indexOf(e.search_agent.toLowerCase())>-1})}}});