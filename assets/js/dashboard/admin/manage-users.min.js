const vuetify=new Vuetify(vuetify_opts),api_url=ra_elite_usa_insurance_ajaxurl;let vm=new Vue({vuetify:vuetify,el:"#ra-elite-usa-insurance-container",data:{selectedItem:3,barAlert:!1,barTimeout:6e3,barMessage:"",notifications_loading:!1,table_loading:!1,logout_loading:!1,contract_loading:!1,user_form_valid:!1,user_id:url_params.get("user_id"),routes:routes,notifications:[],rules:{required:[e=>!!e||"This field is required"],email:[e=>!!e||"E-mail is required",e=>/.+@.+\..+/.test(e)||"E-mail must be valid"]},users:{view_dialog:!1,edit_dialog:!1,delete_dialog:!1,save_loading:!1,delete_loading:!1,search:"",roles:["Administrator","Insurance Agent","Policy Quote manager","Super User"],header:[{text:"Full Name",align:"start",value:"full_name"},{text:"Email",align:"start",value:"email"},{text:"Profile",align:"start",value:"profile"},{text:"Actions",value:"actions",align:"center",sortable:!1}],items:[],editedItem:{user_login:"",first_name:"",last_name:"",email:"",roles:[],profile:"",user_pass:"",send_user_notification:"0"},defaultItem:{user_login:"",first_name:"",last_name:"",email:"",roles:[],profile:"",user_pass:"",send_user_email:"0"},editedIndex:-1}},computed:{formTitle(){return-1===this.users.editedIndex?"New User":"Edit User"}},watch:{},created(){null===this.user_id?this.initialize():this.initializeAndPrevisualize(),initNotifications(this),setInterval(initNotifications,3e4,this)},mounted(){},methods:{logout(){var e=this,s=api_url+"ra_elite_usa_insurance_logout";e.logout_loading=!0,e.$http.get(s).then(s=>{e.logout_loading=!1,window.location=s.body.redirect_url},s=>{e.logout_loading=!1})},initialize(){var e=this,s=api_url+"ra_elite_usa_insurance_get_users";e.table_loading=!0,e.$http.get(s).then(s=>{e.table_loading=!1,e.users.items=[],s.body.length>0&&s.body.forEach(s=>{s.full_name=s.first_name+" "+s.last_name,s.profile=e.displayRol(s.roles[0]),s.user_pass="",s.send_user_email="0",e.users.items.push(s)})},s=>{e.table_loading=!1})},initializeAndPrevisualize(){var e=this,s=api_url+"ra_elite_usa_insurance_get_users";e.table_loading=!0,e.$http.get(s).then(s=>{e.table_loading=!1,e.users.items=[],s.body.length>0&&s.body.forEach(s=>{s.full_name=s.first_name+" "+s.last_name,s.profile=e.displayRol(s.roles[0]),s.user_pass="",s.send_user_email="0",e.users.items.push(s)});var t=e.users.items.filter(s=>parseInt(s.id)==parseInt(e.user_id));t.length>0?(e.showItem(t[0]),e.generateContractPDF()):(e.barAlert=!0,e.barMessage="The user requested is not available")},s=>{e.table_loading=!1})},showItem(e){this.users.editedIndex=this.users.items.indexOf(e),this.users.editedItem=Object.assign({},e),this.users.view_dialog=!0},editItem(e){this.users.editedIndex=this.users.items.indexOf(e),this.users.editedItem=Object.assign({},e),this.users.edit_dialog=!0},deleteItem(e){this.users.editedIndex=this.users.items.indexOf(e),this.users.editedItem=Object.assign({},e),this.users.delete_dialog=!0},closeView(){this.users.view_dialog=!1,this.$nextTick(()=>{this.users.editedItem=Object.assign({},this.users.defaultItem),this.users.editedIndex=-1})},closeEdit(){this.users.edit_dialog=!1,this.view_dialog||this.$nextTick(()=>{this.users.editedItem=Object.assign({},this.users.defaultItem),this.users.editedIndex=-1})},closeDelete(){this.users.delete_dialog=!1,this.$nextTick(()=>{this.users.editedItem=Object.assign({},this.users.defaultItem),this.users.editedIndex=-1})},displayRol(e){switch(e){case"administrator":return"Administrator";case"elite_usa_quote_manager":return"Policy Quote manager";case"elite_usa_insurance_agent":return"Insurance Agent";case"elite_usa_superuser":return"Super User";default:return""}},displayRolValue(e){switch(e){case"Administrator":return"administrator";case"Policy Quote manager":return"elite_usa_quote_manager";case"Insurance Agent":return"elite_usa_insurance_agent";case"Super User":return"elite_usa_superuser";default:return""}},saveUser(){var e=this,s=e.users.editedItem;if(s.roles[0]=e.displayRolValue(s.profile),e.users.save_loading=!0,-1!=e.users.editedIndex){var t=e.users.editedIndex,i=api_url+"ra_elite_usa_insurance_update_user";e.$http.post(i,e.users.editedItem).then(s=>{e.users.save_loading=!1,e.barAlert=!0,e.barMessage=s.body.message,e.users.editedItem.full_name=e.users.editedItem.first_name+" "+e.users.editedItem.last_name,Object.assign(e.users.items[t],e.users.editedItem),e.closeEdit()},s=>{e.users.save_loading=!1,e.barAlert=!0,e.barMessage="There was an unknown error, try again."})}else{i=api_url+"ra_elite_usa_insurance_create_user";e.$http.post(i,e.users.editedItem).then(s=>{e.users.save_loading=!1,"success"==s.body.status&&(e.users.editedItem.id=s.body.data,e.users.editedItem.full_name=e.users.editedItem.first_name+" "+e.users.editedItem.last_name,e.users.items.push(e.users.editedItem),e.closeEdit()),e.barAlert=!0,e.barMessage=s.body.message},s=>{e.users.save_loading=!1,e.barAlert=!0,e.barMessage="There was an unknown error, try again."})}},deleteUser(){var e=this,s=(e.users.editedItem,e.users.editedIndex),t=api_url+"ra_elite_usa_insurance_delete_user";e.users.delete_loading=!0,e.$http.post(t,e.users.editedItem).then(t=>{e.users.delete_loading=!1,e.barAlert=!0,e.barMessage=t.body.message,e.users.items.splice(s,1),e.closeDelete()},s=>{e.users.delete_loading=!1,e.barAlert=!0,e.barMessage="There was an unknown error, try again."}),e.users.editedIndex},generatePassword(){for(var e=15,s="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",t="",i=0,a=s.length;i<e;++i)t+=s.charAt(Math.floor(Math.random()*a));return t},generateContractPDF(){var e=this,s=e.users.editedItem,t=api_url+"ra_elite_usa_insurance_generate_contract_pdf";e.contract_loading=!0;var i=s.first_name+" "+s.last_name;e.$http.post(t,s.agreement_form).then(s=>{if("success"==s.body.status){e.contract_loading=!1;var t=s.body,a=document.createElement("a");a.href=t.content,document.body.append(a),a.download=i+" - Contract.pdf",a.click(),a.remove()}},e=>{})}}});